CREATE VIEW	business_intelligence.exclusive_contract_analysis_sf_change_overview_post_sf_aux AS
SELECT		business_intelligence.exclusive_contract_analysis_searches_post_sf_change.offer_id,
			business_intelligence.offer_base_exclusive_contract_analysis.contract_exclusive,
			business_intelligence.offer_base_exclusive_contract_analysis.sf_drop,
			business_intelligence.offer_base_exclusive_contract_analysis.offer_type,
			business_intelligence.offer_base_exclusive_contract_analysis.number_of_units,
			business_intelligence.offer_base_exclusive_contract_analysis.contract_type,
			business_intelligence.offer_base_exclusive_contract_analysis.contract_has_admin_fee,
			business_intelligence.offer_base_exclusive_contract_analysis.rent,
			business_intelligence.offer_base_exclusive_contract_analysis.address_city_code,
			LEFT(business_intelligence.offer_base_exclusive_contract_analysis.address_city_code,2),
			business_intelligence.exclusive_contract_analysis_searches_post_sf_change.date,
			business_intelligence.exclusive_contract_analysis_searches_post_sf_change.nbr_searches_post_sf,
			business_intelligence.exclusive_contract_analysis_clicks_post_sf_change.nbr_clicks_post_sf,
			business_intelligence.exclusive_contract_analysis_requests_post_sf_change.nbr_requests_post_sf
FROM		business_intelligence.exclusive_contract_analysis_searches_post_sf_change
LEFT JOIN	business_intelligence.exclusive_contract_analysis_clicks_post_sf_change
				ON 	business_intelligence.exclusive_contract_analysis_clicks_post_sf_change.offer_id = 
					business_intelligence.exclusive_contract_analysis_searches_post_sf_change.offer_id
				AND business_intelligence.exclusive_contract_analysis_clicks_post_sf_change.date = 
					business_intelligence.exclusive_contract_analysis_searches_post_sf_change.date
LEFT JOIN	business_intelligence.exclusive_contract_analysis_requests_post_sf_change
				ON 	business_intelligence.exclusive_contract_analysis_requests_post_sf_change.offer_id = 
					business_intelligence.exclusive_contract_analysis_searches_post_sf_change.offer_id
				AND business_intelligence.exclusive_contract_analysis_requests_post_sf_change.date = 
					business_intelligence.exclusive_contract_analysis_searches_post_sf_change.date
LEFT JOIN	business_intelligence.offer_base_exclusive_contract_analysis
				ON business_intelligence.offer_base_exclusive_contract_analysis.offer_id = business_intelligence.exclusive_contract_analysis_searches_post_sf_change.offer_id


;


CREATE VIEW	business_intelligence.exclusive_contract_analysis_sf_change_overview_post_sf AS
SELECT		*
FROM		business_intelligence.exclusive_contract_analysis_sf_change_overview_post_sf_aux
WHERE		contract_exclusive IS NOT NUL
