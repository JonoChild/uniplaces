CREATE VIEW	business_intelligence.exclusive_contract_analysis_sf_change_overview_pre_sf AS

SELECT		business_intelligence.exclusive_contract_analysis_searches_pre_sf_change.offer_id,
			business_intelligence.offer_base_exclusive_contract_analysis.contract_exclusive,
			business_intelligence.offer_base_exclusive_contract_analysis.sf_drop,
			business_intelligence.offer_base_exclusive_contract_analysis.offer_type,
			business_intelligence.offer_base_exclusive_contract_analysis.number_of_units,
			business_intelligence.offer_base_exclusive_contract_analysis.contract_type,
			business_intelligence.offer_base_exclusive_contract_analysis.contract_has_admin_fee,
			business_intelligence.offer_base_exclusive_contract_analysis.rent,
			business_intelligence.offer_base_exclusive_contract_analysis.address_city_code,
			LEFT(business_intelligence.offer_base_exclusive_contract_analysis.address_city_code,2) as market,
			business_intelligence.exclusive_contract_analysis_searches_pre_sf_change.date,
			business_intelligence.exclusive_contract_analysis_searches_pre_sf_change.nbr_searches_pre_sf,
			business_intelligence.exclusive_contract_analysis_clicks_pre_sf_change.nbr_clicks_pre_sf,
			business_intelligence.exclusive_contract_analysis_requests_pre_sf_change.nbr_requests_pre_sf
FROM		business_intelligence.exclusive_contract_analysis_searches_pre_sf_change
LEFT JOIN	business_intelligence.exclusive_contract_analysis_clicks_pre_sf_change
				ON 	business_intelligence.exclusive_contract_analysis_clicks_pre_sf_change.offer_id = 
					business_intelligence.exclusive_contract_analysis_searches_pre_sf_change.offer_id
				AND business_intelligence.exclusive_contract_analysis_clicks_pre_sf_change.date = 
					business_intelligence.exclusive_contract_analysis_searches_pre_sf_change.date
LEFT JOIN	business_intelligence.exclusive_contract_analysis_requests_pre_sf_change
				ON 	business_intelligence.exclusive_contract_analysis_requests_pre_sf_change.offer_id = 
					business_intelligence.exclusive_contract_analysis_searches_pre_sf_change.offer_id
				AND business_intelligence.exclusive_contract_analysis_requests_pre_sf_change.date = 
					business_intelligence.exclusive_contract_analysis_searches_pre_sf_change.date
LEFT JOIN	business_intelligence.offer_base_exclusive_contract_analysis
				ON business_intelligence.offer_base_exclusive_contract_analysis.offer_id = business_intelligence.exclusive_contract_analysis_searches_pre_sf_change.offer_id
